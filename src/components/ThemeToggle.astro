---
---

<div class="fixed top-8 right-8 sm:top-4 sm:right-4 z-[1000]">
  <div class="relative">
    <button class="w-9 h-9 sm:w-8 sm:h-8 rounded-full border-0 bg-transparent cursor-pointer p-0 transition-all duration-200 hover:scale-110 mr-2" id="theme-toggle-btn">
      <div class="w-full h-full rounded-full shadow-md" id="current-color" style="box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);"></div>
    </button>
    <div class="absolute top-[calc(100%+0.5rem)] right-0 bg-bg-primary rounded-xl p-2 flex flex-col gap-2 opacity-0 invisible -translate-y-2.5 transition-all duration-200 shadow-lg" id="theme-dropdown" style="box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);">
      <button class="w-9 h-9 sm:w-8 sm:h-8 rounded-full border-0 bg-transparent cursor-pointer p-0 transition-all duration-200 relative hover:scale-[1.15] color-option" data-theme="blue" title="Blue">
        <div class="w-full h-full rounded-full shadow-md" style="background: #3b82f6; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);"></div>
      </button>
      <button class="w-9 h-9 sm:w-8 sm:h-8 rounded-full border-0 bg-transparent cursor-pointer p-0 transition-all duration-200 relative hover:scale-[1.15] color-option" data-theme="green" title="Green">
        <div class="w-full h-full rounded-full shadow-md" style="background: #10b981; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);"></div>
      </button>
      <button class="w-9 h-9 sm:w-8 sm:h-8 rounded-full border-0 bg-transparent cursor-pointer p-0 transition-all duration-200 relative hover:scale-[1.15] color-option" data-theme="orange" title="Orange">
        <div class="w-full h-full rounded-full shadow-md" style="background: #f97316; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);"></div>
      </button>
      <button class="w-9 h-9 sm:w-8 sm:h-8 rounded-full border-0 bg-transparent cursor-pointer p-0 transition-all duration-200 relative hover:scale-[1.15] color-option" data-theme="mono" title="Black/White">
        <div class="w-full h-full rounded-full shadow-md" style="background: linear-gradient(90deg, #000 50%, #fff 50%); box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);"></div>
      </button>
    </div>
  </div>
</div>

<script>
  const toggleBtn = document.getElementById('theme-toggle-btn');
  const dropdown = document.getElementById('theme-dropdown');
  const currentColor = document.getElementById('current-color');
  const colorOptions = document.querySelectorAll('.color-option');
  const root = document.documentElement;

  const themeColors: Record<string, string> = {
    blue: '#3b82f6',
    green: '#10b981',
    orange: '#f97316',
    mono: 'linear-gradient(90deg, #000 50%, #fff 50%)'
  };

  function getStoredTheme() {
    return localStorage.getItem('theme') || 'orange';
  }

  function updateCurrentColor(theme: string) {
    if (currentColor) {
      currentColor.style.background = themeColors[theme];
    }
  }

  function applyTheme(themeName: string) {
    root.classList.remove('green', 'orange', 'mono');

    if (themeName !== 'blue') {
      root.classList.add(themeName);
    }

    localStorage.setItem('theme', themeName);
    updateCurrentColor(themeName);

    colorOptions.forEach(btn => {
      if (btn.getAttribute('data-theme') === themeName) {
        btn.classList.add('active');
      } else {
        btn.classList.remove('active');
      }
    });
  }

  applyTheme(getStoredTheme());

  toggleBtn?.addEventListener('click', () => {
    dropdown?.classList.toggle('dropdown-open');
  });

  document.addEventListener('click', (e) => {
    if (!toggleBtn?.contains(e.target as Node) && !dropdown?.contains(e.target as Node)) {
      dropdown?.classList.remove('dropdown-open');
    }
  });

  colorOptions.forEach(button => {
    button.addEventListener('click', () => {
      const theme = button.getAttribute('data-theme');
      if (theme) {
        applyTheme(theme);
        dropdown?.classList.remove('dropdown-open');
      }
    });
  });
</script>

<style>
  .color-option.active::after {
    content: '';
    position: absolute;
    inset: -4px;
    border-radius: 50%;
    border: 2px solid var(--accent);
    animation: pulse-ring 1.5s ease-out infinite;
  }

  @keyframes pulse-ring {
    0% {
      box-shadow: 0 0 0 0 var(--accent);
    }
    70% {
      box-shadow: 0 0 0 6px transparent;
    }
    100% {
      box-shadow: 0 0 0 0 transparent;
    }
  }
</style>
